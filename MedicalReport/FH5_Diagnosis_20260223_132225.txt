地平线5网络诊断报告 - 2026-02-23 13:22:25
============================================================

📊 诊断概要
----------------------------------------
诊断时间: 2026-02-23 13:19:31
诊断结果: ⚠️ 发现问题
发现问题数: 6
总耗时: 173.5秒

🔧 第一步：网络连接检查
----------------------------------------
状态: ❌ 失败
互联网连接: 正常
Teredo适配器: Up
Teredo启用: 是
NAT类型: 开放
Xbox服务可达: 否
失败原因: Xbox网络服务不可达

🔍 第二步：DNS和IP配置诊断
----------------------------------------
状态: ✅ 通过
DNS服务器: 192.168.110.1, fec0:0:0:ffff::1, fec0:0:0:ffff::2, fec0:0:0:ffff::3
IP地址: 192.168.110.56, 169.254.220.35, 169.254.194.45, 169.254.136.42, 172.16.3.66
DNS解析Xbox: 成功
DNS缓存状态: 无缓存或异常

🎮 第三步：Xbox服务状态查询
----------------------------------------
状态: ❌ 失败
Xbox Live核心服务: 在线
Xbox 社交服务: 在线
Xbox 商店服务: 在线
本地凭据状态: 存在凭据文件
地平线4注意事项: 地平线4代token有时效限制，意思就是，你登录完账号之后，过一段时间Xbox就会不认你这个账号凭据，你需要重新登录才能连接到线上
地平线5注意事项: 在线模式需绑定家园作为spawn点，未设导致连接循环，设置后autosave生效，解锁多人。意思是，你需要开车到你的房子中把这个设置为家，随后重启游戏
失败原因: 未知原因

🛡️ 第四步：VPN和防火墙检测
----------------------------------------
状态: ❌ 失败
VPN检测: 检测到VPN
IPv6配置: 已启用
防火墙状态: 已禁用
端口3074: 开放
端口3544: 开放
失败原因: 检测到VPN

⚙️ 第五步：冲突服务检查
----------------------------------------
状态: ✅ 通过
未发现冲突服务

🔧 第六步：必要服务状态检查
----------------------------------------
未完成或结果为空

🌐 Teredo服务器延迟测试
----------------------------------------
✅ win1910.ipv6.microsoft.com: Ping延迟: 101ms, TCP连接失败
❌ teredo.remlab.net: 测试失败
❌ teredo-debian.remlab.net: 测试失败
❌ teredo.autotrans.consulintel.com: 测试失败
❌ teredo.ipv6.microsoft.com: 测试失败

🚀 推荐Teredo服务器: win1910.ipv6.microsoft.com (延迟: 101ms)

🎮 游戏服务器延迟测试
----------------------------------------
✅ 日本1: Ping延迟: 79ms, TCP延迟: 62ms
✅ 美西服1: Ping延迟: 63ms, TCP延迟: 84ms
✅ 美西服2: Ping延迟: 62ms, TCP延迟: 61ms
❌ 德国1: 测试失败
❌ 芬兰1: Ping失败, TCP连接失败

🚀 推荐游戏服务器: 美西服2 (延迟: 62ms)

⚠️ 发现的问题
----------------------------------------
1. Xbox 联机服务(xbox.ipv6.microsoft.com:443) 连接失败
   详细信息: 无法连接到Xbox服务
2. Teredo 服务器(teredo.ipv6.microsoft.com:3544) 连接失败
   详细信息: 无法连接到Xbox服务
3. Xbox网络服务连接不稳定
   详细信息: 可能导致无法登录Xbox Live
4. 检测到VPN
   详细信息: VPN可能干扰Teredo隧道
5. 冲突服务检查过程异常
   详细信息: 在创建窗口句柄之前，不能在控件上调用 Invoke 或 BeginInvoke。
6. 诊断过程异常
   详细信息: 在创建窗口句柄之前，不能在控件上调用 Invoke 或 BeginInvoke。

💡 修复建议
----------------------------------------
1. 使用延迟最低的Teredo服务器: win1910.ipv6.microsoft.com
2. 请确保在地平线5中已将当前房屋设置为【家】(Home)，否则可能无法连接Horizon Life
3. 临时禁用VPN尝试连接

============================================================
地平线5网络诊断报告 - 生成完成
报告生成时间: 2026-02-23 13:22:25
